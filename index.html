<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PhySiCaS - Physics Simulations and Calculations Software</title>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            }
        };
    </script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Computer+Modern:wght@400;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=TH+Sarabun+PSK:wght@400;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Computer Modern', serif;
            background: linear-gradient(135deg, #87CEEB 0%, #E6E6FA 50%, #98FB98 100%);
            min-height: 100vh;
            color: #333;
            position: relative;
            overflow-x: hidden;
        }
        
        /* New animated background styles */
        @keyframes floatScience {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            25% { transform: translateY(-20px) rotate(5deg); }
            50% { transform: translateY(-40px) rotate(0deg); }
            75% { transform: translateY(-20px) rotate(-5deg); }
        }
        
        @keyframes driftLine {
            0% { transform: translateX(-100px); }
            100% { transform: translateX(calc(100vw + 100px)); }
        }
        
        @keyframes pulseCircle {
            0%, 100% { transform: scale(1); opacity: 0.3; }
            50% { transform: scale(1.2); opacity: 0.5; }
        }
        
        @keyframes bubbleFloat {
            0%, 100% { transform: translateY(0px) scale(1); }
            50% { transform: translateY(-25px) scale(1.05); }
        }
        
        /* Animation classes */
        .float-sci-1 { animation: floatScience 8s ease-in-out infinite; }
        .float-sci-2 { animation: floatScience 12s ease-in-out infinite 2s; }
        .float-sci-3 { animation: floatScience 10s ease-in-out infinite 4s; }
        .float-sci-4 { animation: floatScience 14s ease-in-out infinite 1s; }
        .float-sci-5 { animation: floatScience 9s ease-in-out infinite 3s; }
        .float-sci-6 { animation: floatScience 11s ease-in-out infinite 5s; }
        
        .bubble-sci-1 { animation: bubbleFloat 15s ease-in-out infinite; }
        .bubble-sci-2 { animation: bubbleFloat 18s ease-in-out infinite 3s; }
        .bubble-sci-3 { animation: bubbleFloat 16s ease-in-out infinite 6s; }
        .bubble-sci-4 { animation: bubbleFloat 20s ease-in-out infinite 2s; }
        
        .drift-sci-1 { animation: driftLine 20s linear infinite; }
        .drift-sci-2 { animation: driftLine 25s linear infinite 5s; }
        .drift-sci-3 { animation: driftLine 18s linear infinite 10s; }
        .drift-sci-4 { animation: driftLine 22s linear infinite 15s; }
        .drift-sci-5 { animation: driftLine 16s linear infinite 8s; }
        
        .pulse-sci-1 { animation: pulseCircle 12s ease-in-out infinite; }
        .pulse-sci-2 { animation: pulseCircle 15s ease-in-out infinite 4s; }
        .pulse-sci-3 { animation: pulseCircle 10s ease-in-out infinite 8s; }
        .pulse-sci-4 { animation: pulseCircle 18s ease-in-out infinite 2s; }
        .pulse-sci-5 { animation: pulseCircle 14s ease-in-out infinite 6s; }
        
        .thai-text {
            font-family: 'TH Sarabun PSK', sans-serif;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }
        
        .header {
            text-align: center;
            background: rgba(255, 255, 255, 0.9);
            padding: 40px;
            border-radius: 30px;
            margin-bottom: 30px;
            box-shadow: 
                0 15px 40px rgba(0, 0, 0, 0.1),
                0 0 30px rgba(255, 192, 203, 0.3),
                inset 0 2px 0 rgba(255, 255, 255, 0.9);
            position: relative;
            overflow: hidden;
            border: 3px solid rgba(255, 192, 203, 0.3);
        }
        
        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,182,193,0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
            pointer-events: none;
        }
        
        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .scientist-icon {
            position: absolute;
            font-size: 32px;
            opacity: 0.6;
            animation: bounce 3s ease-in-out infinite;
            filter: drop-shadow(0 0 8px rgba(255, 255, 255, 0.5));
        }
        
        .scientist-icon:nth-child(1) { top: 15px; left: 25px; animation-delay: 0s; }
        .scientist-icon:nth-child(2) { top: 15px; right: 25px; animation-delay: 1s; }
        .scientist-icon:nth-child(3) { bottom: 15px; left: 60px; animation-delay: 2s; }
        .scientist-icon:nth-child(4) { bottom: 15px; right: 60px; animation-delay: 0.5s; }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(0px) scale(1) rotate(0deg); }
            25% { transform: translateY(-5px) scale(1.1) rotate(5deg); }
            50% { transform: translateY(-15px) scale(1.2) rotate(0deg); }
            75% { transform: translateY(-5px) scale(1.1) rotate(-5deg); }
        }
        
        .header h1 {
            font-size: 3em;
            color: #2c3e50;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .header p {
            font-size: 1.2em;
            color: #7f8c8d;
            margin-bottom: 20px;
        }
        
        .main-menu {
            display: none;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        .main-menu.active {
            display: block;
        }
        
        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .menu-item {
            background: linear-gradient(135deg, #FFB6C1, #FF69B4);
            color: white;
            padding: 30px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            border: none;
            font-family: inherit;
            font-size: 1.2em;
            position: relative;
            overflow: hidden;
            box-shadow: 
                0 12px 30px rgba(255, 182, 193, 0.4),
                0 0 20px rgba(255, 182, 193, 0.3);
            transform: scale(1);
        }
        
        .menu-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .menu-item:hover::before {
            left: 100%;
        }
        
        .menu-item:hover {
            transform: translateY(-8px) scale(1.05);
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.2),
                0 0 30px rgba(144, 238, 144, 0.6),
                0 0 50px rgba(144, 238, 144, 0.4);
            background: linear-gradient(135deg, #98FB98, #90EE90);
        }
        
        .menu-item:nth-child(even) {
            background: linear-gradient(135deg, #DDA0DD, #BA55D3);
            box-shadow: 
                0 12px 30px rgba(221, 160, 221, 0.4),
                0 0 20px rgba(221, 160, 221, 0.3);
        }
        
        .menu-item:nth-child(even):hover {
            background: linear-gradient(135deg, #FFE4B5, #FFA500);
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.2),
                0 0 30px rgba(255, 228, 181, 0.6),
                0 0 50px rgba(255, 228, 181, 0.4);
            transform: translateY(-8px) scale(1.05);
        }
        
        .simulation-page {
            display: none;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 25px;
            padding: 35px;
            box-shadow: 
                0 15px 40px rgba(0, 0, 0, 0.1),
                0 0 30px rgba(255, 192, 203, 0.3),
                inset 0 2px 0 rgba(255, 255, 255, 0.9);
            border: 3px solid rgba(255, 192, 203, 0.2);
        }
        
        .simulation-page.active {
            display: block;
        }
        
        .sim-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #ecf0f1;
        }
        
        .back-btn {
            background: linear-gradient(135deg, #FF6B6B, #FF4757);
            color: white;
            border: none;
            padding: 18px 35px;
            border-radius: 20px;
            cursor: pointer;
            font-family: inherit;
            font-size: 1.1em;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 
                0 8px 20px rgba(255, 107, 107, 0.4),
                0 0 15px rgba(255, 107, 107, 0.3);
            transform: scale(1);
        }
        
        .back-btn:hover {
            background: linear-gradient(135deg, #FF8E8E, #FF6B6B);
            box-shadow: 
                0 12px 25px rgba(255, 107, 107, 0.5),
                0 0 20px rgba(255, 107, 107, 0.4);
            transform: translateY(-3px) scale(1.05);
        }
        
        .sim-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        .left-panel {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .right-panel {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .panel {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.9) 0%, rgba(255, 250, 205, 0.4) 100%);
            border-radius: 20px;
            padding: 25px;
            border: 2px solid rgba(255, 192, 203, 0.3);
            position: relative;
            overflow: hidden;
            box-shadow: 
                0 8px 20px rgba(0, 0, 0, 0.08),
                0 0 15px rgba(255, 250, 205, 0.3),
                inset 0 2px 0 rgba(255, 255, 255, 0.8);
        }
        
        .panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #FFB6C1, #87CEEB, #98FB98, #DDA0DD, #FFE4B5);
            background-size: 400% 100%;
            animation: gradientShift 8s ease infinite;
            border-radius: 20px 20px 0 0;
        }
        
        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        .panel h3 {
            position: relative;
        }
        
        .panel h3::after {
            content: 'üß™';
            position: absolute;
            right: 0;
            top: 0;
            font-size: 0.8em;
            opacity: 0.6;
            animation: wiggle 2s ease-in-out infinite;
        }
        
        .panel:has(h3:contains("Input")) h3::after { content: '‚öôÔ∏è'; }
        .panel:has(h3:contains("Results")) h3::after { content: 'üìä'; }
        .panel:has(h3:contains("Simulation")) h3::after { content: 'üéÆ'; }
        .panel:has(h3:contains("Theory")) h3::after { content: 'üìö'; }
        .panel:has(h3:contains("Graph")) h3::after { content: 'üìà'; }
        
        @keyframes wiggle {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(5deg); }
            75% { transform: rotate(-5deg); }
        }
        
        .panel h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.3em;
        }
        
        .input-group {
            margin-bottom: 15px;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #495057;
        }
        
        .input-group input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid rgba(255, 192, 203, 0.3);
            border-radius: 15px;
            font-family: inherit;
            font-size: 1em;
            background: rgba(255, 255, 255, 0.8);
            transition: all 0.3s ease;
        }
        
        .input-group input:focus {
            border-color: #FFB6C1;
            box-shadow: 0 0 15px rgba(255, 182, 193, 0.3);
            outline: none;
            background: rgba(255, 255, 255, 1);
        }
        
        .calculate-btn {
            background: linear-gradient(135deg, #98FB98, #90EE90);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 20px;
            cursor: pointer;
            font-family: inherit;
            font-size: 1.1em;
            font-weight: 600;
            width: 100%;
            margin-top: 15px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 
                0 8px 20px rgba(152, 251, 152, 0.4),
                0 0 15px rgba(152, 251, 152, 0.3);
            transform: scale(1);
        }
        
        .calculate-btn::before {
            content: '‚ö°';
            position: absolute;
            left: -30px;
            top: 50%;
            transform: translateY(-50%);
            transition: left 0.3s ease;
            font-size: 1.2em;
        }
        
        .calculate-btn:hover::before {
            left: 10px;
        }
        
        .calculate-btn:hover {
            background: #229954;
            padding-left: 40px;
            box-shadow: 
                0 8px 20px rgba(34, 153, 84, 0.4),
                0 0 15px rgba(34, 153, 84, 0.3);
            transform: translateY(-2px);
        }
        
        .canvas-container {
            background: linear-gradient(145deg, white 0%, rgba(173, 216, 230, 0.05) 100%);
            border: 2px solid rgba(173, 216, 230, 0.3);
            border-radius: 10px;
            padding: 10px;
            text-align: center;
            box-shadow: 
                0 5px 15px rgba(0, 0, 0, 0.1),
                0 0 10px rgba(173, 216, 230, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
        }
        
        canvas {
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        
        .output-item {
            background: linear-gradient(135deg, #e8f5e8 0%, rgba(255, 250, 205, 0.3) 100%);
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 10px;
            border-left: 4px solid #27ae60;
            position: relative;
            overflow: hidden;
            box-shadow: 
                0 3px 10px rgba(0, 0, 0, 0.05),
                0 0 5px rgba(39, 174, 96, 0.1);
        }
        
        .output-item::before {
            content: '‚ú®';
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            opacity: 0;
            animation: sparkle 3s ease-in-out infinite;
        }
        
        @keyframes sparkle {
            0%, 100% { opacity: 0; transform: translateY(-50%) scale(0.5); }
            50% { opacity: 1; transform: translateY(-50%) scale(1); }
        }
        
        .theory-content {
            line-height: 1.6;
        }
        
        .formula-box {
            background: linear-gradient(145deg, #f0f8ff 0%, rgba(221, 160, 221, 0.1) 100%);
            border: 1px solid rgba(176, 212, 241, 0.5);
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
            text-align: center;
            box-shadow: 
                0 3px 10px rgba(0, 0, 0, 0.05),
                0 0 8px rgba(176, 212, 241, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.6);
        }
        
        .nav-tabs {
            display: flex;
            justify-content: center;
            gap: 0;
            margin-top: 20px;
            border-bottom: 2px solid #ecf0f1;
        }
        
        .nav-tab {
            background: transparent;
            border: none;
            padding: 12px 24px;
            font-family: inherit;
            font-size: 1.1em;
            color: #7f8c8d;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            border-radius: 8px 8px 0 0;
        }
        
        .nav-tab:hover {
            color: #2c3e50;
            background: linear-gradient(145deg, rgba(116, 185, 255, 0.1), rgba(255, 250, 205, 0.1));
            box-shadow: 0 0 10px rgba(116, 185, 255, 0.2);
        }
        
        .nav-tab.active {
            color: #2c3e50;
            border-bottom-color: #74b9ff;
            font-weight: 600;
            background: linear-gradient(145deg, rgba(116, 185, 255, 0.15), rgba(255, 250, 205, 0.15));
            box-shadow: 
                0 0 15px rgba(116, 185, 255, 0.3),
                0 -3px 10px rgba(116, 185, 255, 0.1);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header {
                padding: 20px 15px;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .header p {
                font-size: 1em;
            }
            
            .sim-content {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .menu-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .menu-item {
                padding: 20px 15px;
                font-size: 1em;
            }
            
            .nav-tabs {
                flex-wrap: wrap;
                gap: 5px;
                justify-content: center;
            }
            
            .nav-tab {
                padding: 8px 12px;
                font-size: 0.9em;
                flex: 1;
                min-width: 80px;
                text-align: center;
            }
            
            .panel {
                padding: 15px;
            }
            
            .panel h3 {
                font-size: 1.1em;
            }
            
            .input-group input {
                font-size: 16px; /* Prevents iOS zoom */
                padding: 10px;
            }
            
            .calculate-btn {
                padding: 12px;
                font-size: 1em;
            }
            
            .back-btn {
                padding: 12px 20px;
                font-size: 1em;
            }
            
            canvas {
                max-width: 100%;
                height: auto;
            }
            
            .canvas-container {
                padding: 8px;
            }
            
            .sim-header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .sim-header h2 {
                font-size: 1.5em;
            }
            
            .formula-box {
                padding: 10px;
                font-size: 0.9em;
            }
            
            .theory-content {
                font-size: 0.9em;
            }
            
            .output-item {
                padding: 8px;
                font-size: 0.9em;
            }
        }
    </style>
</head>
<body>
    <!-- New Animated Background Elements -->
    <!-- Floating Science Icons -->
    <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 0;">
        <!-- Rockets -->
        <div class="float-sci-1" style="position: absolute; top: 10%; left: 10%; font-size: 50px; opacity: 0.3;">üöÄ</div>
        <div class="float-sci-2" style="position: absolute; top: 60%; right: 20%; font-size: 40px; opacity: 0.25;">üöÄ</div>
        
        <!-- Test Tubes -->
        <div class="float-sci-3" style="position: absolute; top: 40%; left: 25%; font-size: 55px; opacity: 0.35;">üß™</div>
        <div class="float-sci-4" style="position: absolute; bottom: 40%; right: 30%; font-size: 45px; opacity: 0.3;">üß™</div>
        
        <!-- Atoms -->
        <div class="float-sci-5" style="position: absolute; top: 80%; right: 10%; font-size: 50px; opacity: 0.4;">‚öõÔ∏è</div>
        <div class="float-sci-6" style="position: absolute; bottom: 60%; left: 20%; font-size: 60px; opacity: 0.25;">‚öõÔ∏è</div>
        
        <!-- Microscopes -->
        <div class="float-sci-1" style="position: absolute; top: 30%; right: 25%; font-size: 50px; opacity: 0.3;">üî¨</div>
        <div class="float-sci-2" style="position: absolute; bottom: 20%; left: 30%; font-size: 45px; opacity: 0.35;">üî¨</div>
        
        <!-- Magnifying Glass -->
        <div class="float-sci-3" style="position: absolute; top: 50%; left: 10%; font-size: 55px; opacity: 0.25;">üîç</div>
        <div class="float-sci-4" style="position: absolute; top: 20%; right: 30%; font-size: 50px; opacity: 0.4;">üîç</div>
        
        <!-- Beakers -->
        <div class="float-sci-5" style="position: absolute; bottom: 30%; right: 20%; font-size: 45px; opacity: 0.3;">‚öóÔ∏è</div>
        <div class="float-sci-6" style="position: absolute; top: 70%; left: 25%; font-size: 50px; opacity: 0.35;">‚öóÔ∏è</div>
    </div>
    
    <!-- Cartoon Scientists in Bubbles -->
    <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 0;">
        <!-- Scientist 1 -->
        <div class="bubble-sci-1" style="position: absolute; top: 15%; left: 30%;">
            <div style="width: 80px; height: 80px; background: rgba(255, 255, 255, 0.2); border-radius: 50%; display: flex; align-items: center; justify-content: center; backdrop-filter: blur(10px); border: 2px solid rgba(255, 255, 255, 0.3);">
                <span style="font-size: 35px;">üë®‚Äçüî¨</span>
            </div>
        </div>
        
        <!-- Scientist 2 -->
        <div class="bubble-sci-2" style="position: absolute; top: 50%; right: 25%;">
            <div style="width: 90px; height: 90px; background: rgba(221, 160, 221, 0.25); border-radius: 50%; display: flex; align-items: center; justify-content: center; backdrop-filter: blur(10px); border: 2px solid rgba(221, 160, 221, 0.4);">
                <span style="font-size: 40px;">üë©‚Äçüî¨</span>
            </div>
        </div>
        
        <!-- Scientist 3 -->
        <div class="bubble-sci-3" style="position: absolute; bottom: 30%; left: 25%;">
            <div style="width: 70px; height: 70px; background: rgba(173, 216, 230, 0.3); border-radius: 50%; display: flex; align-items: center; justify-content: center; backdrop-filter: blur(10px); border: 2px solid rgba(173, 216, 230, 0.35);">
                <span style="font-size: 30px;">üßë‚Äçüî¨</span>
            </div>
        </div>
        
        <!-- Scientist 4 -->
        <div class="bubble-sci-4" style="position: absolute; top: 65%; right: 30%;">
            <div style="width: 85px; height: 85px; background: rgba(152, 251, 152, 0.25); border-radius: 50%; display: flex; align-items: center; justify-content: center; backdrop-filter: blur(10px); border: 2px solid rgba(152, 251, 152, 0.4);">
                <span style="font-size: 35px;">üë®‚Äçüî¨</span>
            </div>
        </div>
    </div>
    
    <!-- Animated Abstract Lines -->
    <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 0;">
        <!-- Horizontal Lines -->
        <div class="drift-sci-1" style="position: absolute; top: 25%; width: 200px; height: 4px; background: linear-gradient(90deg, transparent, rgba(173, 216, 230, 0.6), transparent); border-radius: 10px; filter: blur(0.3px);"></div>
        <div class="drift-sci-2" style="position: absolute; top: 50%; width: 150px; height: 4px; background: linear-gradient(90deg, transparent, rgba(221, 160, 221, 0.6), transparent); border-radius: 10px; filter: blur(0.3px);"></div>
        <div class="drift-sci-3" style="position: absolute; top: 75%; width: 180px; height: 4px; background: linear-gradient(90deg, transparent, rgba(152, 251, 152, 0.6), transparent); border-radius: 10px; filter: blur(0.3px);"></div>
        <div class="drift-sci-4" style="position: absolute; top: 35%; width: 120px; height: 4px; background: linear-gradient(90deg, transparent, rgba(255, 192, 203, 0.6), transparent); border-radius: 10px; filter: blur(0.3px);"></div>
        <div class="drift-sci-5" style="position: absolute; top: 65%; width: 160px; height: 4px; background: linear-gradient(90deg, transparent, rgba(255, 228, 181, 0.6), transparent); border-radius: 10px; filter: blur(0.3px);"></div>
    </div>
    
    <!-- Soft Pastel Circles -->
    <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 0;">
        <!-- Sky Blue Circles -->
        <div class="pulse-sci-1" style="position: absolute; top: 10%; left: 15%; width: 120px; height: 120px; background: rgba(135, 206, 235, 0.2); border-radius: 50%; filter: blur(20px);"></div>
        <div class="pulse-sci-2" style="position: absolute; bottom: 20%; right: 20%; width: 180px; height: 180px; background: rgba(135, 206, 235, 0.15); border-radius: 50%; filter: blur(30px);"></div>
        
        <!-- Purple Circles -->
        <div class="pulse-sci-3" style="position: absolute; top: 50%; left: 30%; width: 150px; height: 150px; background: rgba(221, 160, 221, 0.25); border-radius: 50%; filter: blur(25px);"></div>
        <div class="pulse-sci-4" style="position: absolute; top: 25%; right: 15%; width: 100px; height: 100px; background: rgba(221, 160, 221, 0.3); border-radius: 50%; filter: blur(15px);"></div>
        
        <!-- Mint Circles -->
        <div class="pulse-sci-5" style="position: absolute; bottom: 30%; left: 10%; width: 140px; height: 140px; background: rgba(152, 251, 152, 0.2); border-radius: 50%; filter: blur(25px);"></div>
        <div class="pulse-sci-1" style="position: absolute; top: 70%; right: 25%; width: 110px; height: 110px; background: rgba(152, 251, 152, 0.25); border-radius: 50%; filter: blur(20px);"></div>
        
        <!-- Pink Circles -->
        <div class="pulse-sci-2" style="position: absolute; top: 40%; left: 50%; width: 170px; height: 170px; background: rgba(255, 192, 203, 0.15); border-radius: 50%; filter: blur(35px);"></div>
        <div class="pulse-sci-3" style="position: absolute; bottom: 15%; left: 25%; width: 80px; height: 80px; background: rgba(255, 192, 203, 0.35); border-radius: 50%; filter: blur(12px);"></div>
    </div>
    
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="scientist-icon">üë®‚Äçüî¨</div>
            <div class="scientist-icon">üî¨</div>
            <div class="scientist-icon">‚öóÔ∏è</div>
            <div class="scientist-icon">üë©‚Äçüî¨</div>
            <h1>PhySiCaS</h1>
            <p>Physics Simulations and Calculations Software</p>
            
            <!-- Navigation Tabs -->
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="showTab('simulations')">Simulations</button>
                <button class="nav-tab" onclick="showTab('update')">Version</button>
                <button class="nav-tab" onclick="showTab('contact')">About Us</button>
            </div>
        </div>

        <!-- Tab Contents -->
        <div class="tab-content active" id="simulations">
            <!-- Main Menu -->
            <div class="main-menu active" id="mainMenu">
                <div class="menu-grid">
                    <button class="menu-item" onclick="showSimulation('projectile')">
                        <h3>üöÄ Projectile Motion</h3>
                    </button>
                    <button class="menu-item" onclick="showSimulation('spring')">
                        <h3>üöÄ Mass-Spring System</h3>
                    </button>
                    <button class="menu-item" onclick="showSimulation('lens')">
                        <h3>ü™û Lens</h3>
                    </button>
                    <button class="menu-item" onclick="showSimulation('mirror')">
                        <h3>ü™û Curved Mirror</h3>
                    </button>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="contact">
            <div style="background: rgba(255, 255, 255, 0.95); border-radius: 15px; padding: 30px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2); text-align: center;">
                <h2 style="color: #2c3e50; margin-bottom: 20px;">Contact</h2>
                <p style="color: #2c3e50; font-size: 1.2em; margin-bottom: 10px;">üìß Email:</p>
                <p style="color: #3498db; font-size: 1.3em; font-weight: 600; margin-bottom: 20px;">puttitorn.w@gmail.com</p>
                <p style="color: #2c3e50; margin-bottom: 5px;">This website was created as a computer project by students of Suankularbwittayalai Rangsit School, Thailand</p>
            </div>
        </div>

        <div class="tab-content" id="update">
            <div style="background: rgba(255, 255, 255, 0.95); border-radius: 15px; padding: 30px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2); text-align: center;">
                <h2 style="color: #2c3e50; margin-bottom: 20px;">Version 1.0</h2>
                <ul style="list-style: none; padding-left: 0; margin-left: 0; text-align: left;">
                    <li style="margin-bottom: 8px;">‚Ä¢ Release</li>
                </ul>
                <a href="https://docs.google.com/forms/d/e/1FAIpQLSdpPq-TE6YlLQyDopNIqn2KjJHMa0naVyoyu_RrJM4vF8bfeA/viewform?usp=dialog" target="_blank" class="calculate-btn" style="background: #8e44ad; margin-bottom: 5px; text-decoration: none; display: inline-block; text-align: center;">
                    üì® Send suggestions or bugs
                </a>
            </div>
        </div>

        <!-- Projectile Motion Simulation -->
        <div class="simulation-page" id="projectile">
            <div class="sim-header">
                <h2>Projectile Motion</h2>
                <button class="back-btn" onclick="showMainMenu()">‚Üê Back to Menu</button>
            </div>
            <div class="sim-content">
                <div class="left-panel">
                    <!-- Input Panel -->
                    <div class="panel">
                        <h3>Input Parameters</h3>
                        <div class="input-group">
                            <label>$v_0$ - Initial Velocity (m/s):</label>
                            <div style="display: flex; gap: 5px; align-items: center;">
                                <input type="number" id="v0" value="2" step="0.1" style="flex: 1;">
                                <span style="font-weight: bold;">√ó10^</span>
                                <input type="number" id="v0_exp" value="1" step="1" style="width: 60px;" title="Power of 10">
                            </div>
                        </div>
                        <div class="input-group">
                            <label>$\theta$ - Launch Angle (degrees):</label>
                            <input type="number" id="angle" value="45" step="0.1">
                        </div>
                        <div class="input-group">
                            <label>$g$ - Gravitational Acceleration (m/s¬≤):</label>
                            <div style="display: flex; gap: 5px; align-items: center;">
                                <input type="number" id="g" value="9.807" step="0.001" style="flex: 1;">
                                <span style="font-weight: bold;">√ó10^</span>
                                <input type="number" id="g_exp" value="0" step="1" style="width: 60px;" title="Power of 10">
                            </div>
                        </div>
                        <div class="input-group">
                            <label>$\beta$ - Air Resistance Coefficient:</label>
                            <div style="display: flex; gap: 5px; align-items: center;">
                                <input type="number" id="beta" value="0" step="0.001" min="0" style="flex: 1;">
                                <span style="font-weight: bold;">√ó10^</span>
                                <input type="number" id="beta_exp" value="0" step="1" style="width: 60px;" title="Power of 10">
                            </div>
                        </div>
                        <div class="input-group">
                            <label>$m$ - Mass (kg):</label>
                            <div style="display: flex; gap: 5px; align-items: center;">
                                <input type="number" id="mass" value="1" step="0.1" min="0.1" style="flex: 1;">
                                <span style="font-weight: bold;">√ó10^</span>
                                <input type="number" id="mass_exp" value="0" step="1" style="width: 60px;" title="Power of 10">
                            </div>
                        </div>
                        <div class="input-group">
                            <label>Time Speed Multiplier:</label>
                            <input type="number" id="timeSpeed" value="1" step="0.1" min="0.1" max="5">
                        </div>
                        <button class="calculate-btn" onclick="calculateProjectile()">Calculate</button>
                    </div>

                    <!-- Output Panel -->
                    <div class="panel">
                        <h3>Results</h3>
                        <div id="projectileResults">
                            <div class="output-item">Click "Calculate" to see results</div>
                        </div>
                    </div>
                </div>

                <div class="right-panel">
                    <!-- Simulation Panel -->
                    <div class="panel">
                        <h3>Simulation</h3>
                        <div class="canvas-container">
                            <canvas id="projectileCanvas" width="400" height="300"></canvas>
                            <div style="margin-top: 10px;">
                                <button class="calculate-btn" onclick="animateProjectile()" style="width: auto; padding: 8px 16px; margin: 5px;">‚ñ∂Ô∏è Start</button>
                                <button onclick="stopAnimation()" style="background: #e74c3c; color: white; border: none; padding: 8px 16px; margin: 5px; border-radius: 5px; cursor: pointer;">‚èπÔ∏è Stop</button>
                                <button id="projectilePauseBtn" onclick="toggleProjectilePause()" style="background: #f39c12; color: white; border: none; padding: 8px 16px; margin: 5px; border-radius: 5px; cursor: pointer;">‚è∏Ô∏è Pause</button>
                                <div style="margin-top: 15px; padding: 10px; background: #f8f9fa; border-radius: 5px; border: 2px solid #3498db;">
                                    <strong style="font-size: 16px; color: #2c3e50;">Time: <span id="projectileTime" style="color: #e74c3c; font-size: 18px;">0.00</span> s</strong>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Graphs Panel -->
                    <div class="panel">
                        <h3>Position vs Time Graphs</h3>
                        <div class="canvas-container">
                            <canvas id="projectileGraphs" width="500" height="350"></canvas>
                        </div>
                    </div>

                    <!-- Theory Panel -->
                    <div class="panel">
                        <h3>Theory & Formulas</h3>
                        <div class="theory-content">
                            <div class="formula-box">
                                <strong>Air Resistance Force Formula:</strong><br>
                                $\vec{F}_\mathrm{drag} = -\beta\vec{v}$<br>
                                where $\beta$ is the air resistance coefficient
                            </div>
                            <div class="formula-box">
                                <strong>Key Results (without air resistance):</strong><br>
                                Range: $R = \dfrac{v_0^2 \sin(2\theta)}{g}$<br>
                                Maximum height: $H = \dfrac{v_0^2 \sin^2(\theta)}{2g}$<br>
                                Flight time: $\tau = \dfrac{2v_0 \sin(\theta)}{g}$
                            </div>
                        </div>
                        
                        <!-- PDF Link Section -->
                        <div style="margin-top: 20px; padding-top: 15px; border-top: 2px solid #ecf0f1;">
                            <h4 style="color: #2c3e50; margin-bottom: 10px;">üìö Advanced Theory</h4>
                            <a href="https://drive.google.com/file/d/1zFsCJv4yQnW8GMCfmDeZujdFCfh31WIK/view?usp=sharing" target="_blank" class="calculate-btn" style="background: #8e44ad; margin-bottom: 5px; text-decoration: none; display: inline-block; text-align: center;">
                                üìÑ Projectile Motion Theory (PDF)
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mass-Spring System Simulation -->
        <div class="simulation-page" id="spring">
            <div class="sim-header">
                <h2>Mass-Spring System</h2>
                <button class="back-btn" onclick="showMainMenu()">‚Üê Back to Menu</button>
            </div>
            <div class="sim-content">
                <div class="left-panel">
                    <div class="panel">
                        <h3>Input Parameters</h3>
                        <div class="input-group">
                            <label>$m$ - Mass (kg):</label>
                            <div style="display: flex; gap: 5px; align-items: center;">
                                <input type="number" id="springMass" value="1" step="0.1" min="0.1" style="flex: 1;">
                                <span style="font-weight: bold;">√ó10^</span>
                                <input type="number" id="springMass_exp" value="0" step="1" style="width: 60px;" title="Power of 10">
                            </div>
                        </div>
                        <div class="input-group">
                            <label>$k$ - Spring Constant (N/m):</label>
                            <div style="display: flex; gap: 5px; align-items: center;">
                                <input type="number" id="springK" value="1" step="0.1" min="0.1" style="flex: 1;">
                                <span style="font-weight: bold;">√ó10^</span>
                                <input type="number" id="springK_exp" value="0" step="1" style="width: 60px;" title="Power of 10">
                            </div>
                        </div>
                        <div class="input-group">
                            <label>$x_0$ - Initial Position (m):</label>
                            <div style="display: flex; gap: 5px; align-items: center;">
                                <input type="number" id="springX0" value="1" step="0.01" style="flex: 1;">
                                <span style="font-weight: bold;">√ó10^</span>
                                <input type="number" id="springX0_exp" value="0" step="1" style="width: 60px;" title="Power of 10">
                            </div>
                        </div>
                        <div class="input-group">
                            <label>$v_0$ - Initial Velocity (m/s):</label>
                            <div style="display: flex; gap: 5px; align-items: center;">
                                <input type="number" id="springV0" value="0" step="0.1" style="flex: 1;">
                                <span style="font-weight: bold;">√ó10^</span>
                                <input type="number" id="springV0_exp" value="0" step="1" style="width: 60px;" title="Power of 10">
                            </div>
                        </div>
                        <div class="input-group">
                            <label>Time Speed Multiplier:</label>
                            <input type="number" id="springTimeSpeed" value="1" step="0.1" min="0.1" max="5">
                        </div>
                        <button class="calculate-btn" onclick="calculateSpring()">Calculate</button>
                    </div>

                    <div class="panel">
                        <h3>Results</h3>
                        <div id="springResults">
                            <div class="output-item">Click "Calculate" to see results</div>
                        </div>
                    </div>
                </div>

                <div class="right-panel">
                    <div class="panel">
                        <h3>Simulation</h3>
                        <div class="canvas-container">
                            <canvas id="springCanvas" width="400" height="300"></canvas>
                            <div style="margin-top: 10px;">
                                <button class="calculate-btn" onclick="animateSpring()" style="width: auto; padding: 8px 16px; margin: 5px;">‚ñ∂Ô∏è Start</button>
                                <button onclick="stopSpringAnimation()" style="background: #e74c3c; color: white; border: none; padding: 8px 16px; margin: 5px; border-radius: 5px; cursor: pointer;">‚èπÔ∏è Stop</button>
                                <button id="springPauseBtn" onclick="toggleSpringPause()" style="background: #f39c12; color: white; border: none; padding: 8px 16px; margin: 5px; border-radius: 5px; cursor: pointer;">‚è∏Ô∏è Pause</button>
                                <div style="margin-top: 15px; padding: 10px; background: #f8f9fa; border-radius: 5px; border: 2px solid #3498db;">
                                    <strong style="font-size: 16px; color: #2c3e50;">Time: <span id="springTime" style="color: #e74c3c; font-size: 18px;">0.00</span> s</strong>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Graphs Panel -->
                    <div class="panel">
                        <h3>Position vs Time Graph</h3>
                        <div class="canvas-container">
                            <canvas id="springGraphs" width="500" height="300"></canvas>
                        </div>
                    </div>

                    <div class="panel">
                        <h3>Theory & Formulas</h3>
                        <div class="theory-content">
                            <div class="formula-box">
                                <strong>Equation Of Motion:</strong><br>
                                $m\dfrac{d^2x}{dt^2} = -kx$
                            </div>
                            <div class="formula-box">
                                <strong>Angular Frequency:</strong><br>
                                $\omega = \sqrt{\dfrac{k}{m}}$
                            </div>
                            <div class="formula-box">
                                <strong>Solution:</strong><br>
                                $x(t) = A\cos(\omega t + \phi)$<br>
                                where $A = \sqrt{x_0^2 + \left(\dfrac{v_0}{\omega}\right)^2}$<br>
                                and $\phi = -\arctan\left(\dfrac{v_0}{\omega x_0}\right)$
                            </div>
                            <div class="formula-box">
                                <strong>Period, Frequency:</strong><br>
                                $T = \dfrac{2\pi}{\omega}$, $\nu = \dfrac{\omega}{2\pi}$
                            </div>
                        </div>
                        
                        <!-- PDF Link Section -->
                        <div style="margin-top: 20px; padding-top: 15px; border-top: 2px solid #ecf0f1;">
                            <h4 style="color: #2c3e50; margin-bottom: 10px;">üìö Advanced Theory</h4>
                            <a href="https://drive.google.com/file/d/17__ApGOiK3KUbbuK2BIdie82Iv9EUSo2/view?usp=sharing" target="_blank" class="calculate-btn" style="background: #8e44ad; margin-bottom: 5px; text-decoration: none; display: inline-block; text-align: center;">
                                üìÑ Mass-Spring Theory (PDF)
                            </a>
                            <p>Coming soon</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Lens Simulation -->
        <div class="simulation-page" id="lens">
            <div class="sim-header">
                <h2>Lens</h2>
                <button class="back-btn" onclick="showMainMenu()">‚Üê Back to Menu</button>
            </div>
            <div class="sim-content">
                <div class="left-panel">
                    <!-- Input Panel -->
                    <div class="panel">
                        <h3>Input Parameters (Centimeter is default)</h3>
                        <div class="input-group">
                            <label>$s$ - Object Distance (m) (work only $s>0$):</label>
                            <div style="display: flex; gap: 5px; align-items: center;">
                                <input type="number" id="lenss" value="2" step="0.1" style="flex: 1;">
                                <span style="font-weight: bold;">√ó10</span>
                                <input type="number" id="lenss_exp" value="-2" step="1" style="width: 60px;" title="Power of 10">
                            </div>
                        </div>
                        <div class="input-group">
                            <label>$h$ - Object Height (m):</label>
                            <div style="display: flex; gap: 5px; align-items: center;">
                                <input type="number" id="lensh" value="1" step="0.001" style="flex: 1;">
                                <span style="font-weight: bold;">√ó10</span>
                                <input type="number" id="lensh_exp" value="-2" step="1" style="width: 60px;" title="Power of 10">
                            </div>
                        </div>
                        <div class="input-group">
                            <label>$f$ - Focal Length (m) (+ for convex, - for concave ):</label>
                            <div style="display: flex; gap: 5px; align-items: center;">
                                <input type="number" id="lensf" value="1" step="0.001" style="flex: 1;">
                                <span style="font-weight: bold;">√ó10</span>
                                <input type="number" id="lensf_exp" value="-2" step="1" style="width: 60px;" title="Power of 10">
                            </div>
                        </div>
                        <button class="calculate-btn" onclick="calculateLens()">Calculate</button>
                    </div>

                    <!-- Output Panel -->
                    <div class="panel">
                        <h3>Results</h3>
                        <div id="lensResults">
                            <div class="output-item">Click "Calculate" to see results</div>
                        </div>
                    </div>
                </div>

                <div class="right-panel">
                    <!-- Simulation Panel -->
                    <div class="panel">
                        <h3>Simulation (Thin lens)</h3>
                        <div class="canvas-container">
                            <canvas id="lensCanvas" width="400" height="300"></canvas>
                            <div style="margin-top: 10px;">
                                <button class="calculate-btn" onclick="animateLens()" style="width: auto; padding: 8px 16px; margin: 5px;">‚ñ∂Ô∏è Start</button>
                            </div>
                        </div>
                    </div>

                    <!-- Theory Panel -->
                    <div class="panel">
                        <h3>Theory & Formulas</h3>
                        <div class="theory-content">
                            <div class="formula-box">
                                <strong>Lens Formula:</strong><br>
                                $\dfrac{1}{s}+\dfrac{1}{s'}=\dfrac{1}{f}$<br>
                            </div>
                            <div class="formula-box">
                                <strong>Key Results:</strong><br>
                                Image Distance: $s' = \dfrac{fs}{s-f}$<br>
                                Magnification: $\mathcal{M} = -\dfrac{s'}{s} = \dfrac{h'}{h} = - \dfrac{f}{s-f}$<br>
                                Image Height: $h' = \dfrac{hf}{f-s}$
                            </div>
                        </div>
                        
                        <!-- PDF Link Section -->
                        <div style="margin-top: 20px; padding-top: 15px; border-top: 2px solid #ecf0f1;">
                            <h4 style="color: #2c3e50; margin-bottom: 10px;">üìö Advanced Theory</h4>
                            <a href="#" target="_blank" class="calculate-btn" style="background: #8e44ad; margin-bottom: 5px; text-decoration: none; display: inline-block; text-align: center;">
                                üìÑ Lens Theory (PDF)
                            </a>
                            <p>Coming soon</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Curved Mirror Simulation -->
        <div class="simulation-page" id="mirror">
            <div class="sim-header">
                <h2>Curved Mirror</h2>
                <button class="back-btn" onclick="showMainMenu()">‚Üê Back to Menu</button>
            </div>
            <div class="sim-content">
                <div class="left-panel">
                    <!-- Input Panel -->
                    <div class="panel">
                        <h3>Input Parameters (Centimeter is default)</h3>
                        <div class="input-group">
                            <label>$s$ - Object Distance (m) (work only $s>0$):</label>
                            <div style="display: flex; gap: 5px; align-items: center;">
                                <input type="number" id="mirrors" value="2" step="0.1" style="flex: 1;">
                                <span style="font-weight: bold;">√ó10</span>
                                <input type="number" id="mirrors_exp" value="-2" step="1" style="width: 60px;" title="Power of 10">
                            </div>
                        </div>
                        <div class="input-group">
                            <label>$h$ - Object Height (m):</label>
                            <div style="display: flex; gap: 5px; align-items: center;">
                                <input type="number" id="mirrorh" value="1" step="0.001" style="flex: 1;">
                                <span style="font-weight: bold;">√ó10</span>
                                <input type="number" id="mirrorh_exp" value="-2" step="1" style="width: 60px;" title="Power of 10">
                            </div>
                        </div>
                        <div class="input-group">
                            <label>$R$ - Radius of curvature (m) (+ for concave, - for convex ):</label>
                            <div style="display: flex; gap: 5px; align-items: center;">
                                <input type="number" id="mirrorR" value="1" step="0.001" style="flex: 1;">
                                <span style="font-weight: bold;">√ó10</span>
                                <input type="number" id="mirrorR_exp" value="-2" step="1" style="width: 60px;" title="Power of 10">
                            </div>
                        </div>
                        <button class="calculate-btn" onclick="calculateMirror()">Calculate</button>
                    </div>

                    <!-- Output Panel -->
                    <div class="panel">
                        <h3>Results</h3>
                        <div id="lensResults">
                            <div class="output-item">Click "Calculate" to see results</div>
                        </div>
                    </div>
                </div>

                <div class="right-panel">
                    <!-- Simulation Panel -->
                    <div class="panel">
                        <h3>Simulation (Large mirror)</h3>
                        <div class="canvas-container">
                            <canvas id="lensCanvas" width="400" height="300"></canvas>
                            <div style="margin-top: 10px;">
                                <button class="calculate-btn" onclick="animateMirror()" style="width: auto; padding: 8px 16px; margin: 5px;">‚ñ∂Ô∏è Start</button>
                            </div>
                        </div>
                    </div>

                    <!-- Theory Panel -->
                    <div class="panel">
                        <h3>Theory & Formulas</h3>
                        <div class="theory-content">
                            <div class="formula-box">
                                <strong>Curved Mirror Formula:</strong><br>
                                $\dfrac{1}{s}+\dfrac{1}{s'}=\dfrac{2}{R}$<br>
                            </div>
                            <div class="formula-box">
                                <strong>Key Results:</strong><br>
                                Image Distance: $s' = \dfrac{Rs}{2s-R}$<br>
                                Magnification: $\mathcal{M} = -\dfrac{s'}{s} = \dfrac{h'}{h} = - \dfrac{R}{2s-R}$<br>
                                Image Height: $h' = \dfrac{Rh}{R-2s}$
                            </div>
                        </div>
                        
                        <!-- PDF Link Section -->
                        <div style="margin-top: 20px; padding-top: 15px; border-top: 2px solid #ecf0f1;">
                            <h4 style="color: #2c3e50; margin-bottom: 10px;">üìö Advanced Theory</h4>
                            <a href="#" target="_blank" class="calculate-btn" style="background: #8e44ad; margin-bottom: 5px; text-decoration: none; display: inline-block; text-align: center;">
                                üìÑ Curved Mirror Theory (PDF)
                            </a>
                            <p>Coming soon</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global animation variables
        let animationId = null;
        let springAnimationId = null;
        let projectileIsPaused = false;
        let springIsPaused = false;

        // Navigation functions
        function showTab(tabName) {
            // Stop all animations when switching tabs
            stopAnimation();
            stopSpringAnimation();
            
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.nav-tab').forEach(el => el.classList.remove('active'));
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
            
            // If switching to simulations tab, show main menu
            if (tabName === 'simulations') {
                showMainMenu();
            } else {
                // Hide all simulation pages when switching to other tabs
                document.querySelectorAll('.simulation-page').forEach(el => el.classList.remove('active'));
                document.getElementById('mainMenu').classList.remove('active');
            }
        }
        
        function showMainMenu() {
            document.querySelectorAll('.main-menu, .simulation-page').forEach(el => el.classList.remove('active'));
            document.getElementById('mainMenu').classList.add('active');
        }

        function showSimulation(simType) {
            document.querySelectorAll('.main-menu, .simulation-page').forEach(el => el.classList.remove('active'));
            document.getElementById(simType).classList.add('active');
        }

        // Pause/Resume functions
        function toggleProjectilePause() {
            projectileIsPaused = !projectileIsPaused;
            const btn = document.getElementById('projectilePauseBtn');
            btn.textContent = projectileIsPaused ? '‚ñ∂Ô∏è Resume' : '‚è∏Ô∏è Pause';
        }

        function toggleSpringPause() {
            springIsPaused = !springIsPaused;
            const btn = document.getElementById('springPauseBtn');
            btn.textContent = springIsPaused ? '‚ñ∂Ô∏è Resume' : '‚è∏Ô∏è Pause';
        }

        // Projectile Motion Functions
        function calculateProjectile() {
            const v0 = parseFloat(document.getElementById('v0').value) * Math.pow(10, parseFloat(document.getElementById('v0_exp').value));
            const angleValue = parseFloat(document.getElementById('angle').value);
            const angle = angleValue * Math.PI / 180;
            const beta = parseFloat(document.getElementById('beta').value) * Math.pow(10, parseFloat(document.getElementById('beta_exp').value));
            const mass = parseFloat(document.getElementById('mass').value) * Math.pow(10, parseFloat(document.getElementById('mass_exp').value));
            const g = parseFloat(document.getElementById('g').value) * Math.pow(10, parseFloat(document.getElementById('g_exp').value));

            // Calculate basic parameters
            const v0x = v0 * Math.cos(angle);
            const v0y = v0 * Math.sin(angle);
            
            let range, maxHeight, flightTime;
            
            if (beta === 0) {
                // No air resistance - analytical solution
                flightTime = 2 * v0y / g;
                range = v0x * flightTime;
                maxHeight = (v0y * v0y) / (2 * g);
            } else {
                // With air resistance - numerical integration to find accurate values
                let t = 0;
                const dt = 0.001;
                let x = 0, y = 0;
                let vx = v0x, vy = v0y;
                let maxY = 0;
                
                // Simulate until projectile hits ground
                while (y >= 0 && t < 100) {
                    // Air resistance force components
                    const speed = Math.sqrt(vx * vx + vy * vy);
                    const dragX = -beta * vx / mass;
                    const dragY = -beta * vy / mass;
                    
                    // Update velocities
                    vx += dragX * dt;
                    vy += (dragY - g) * dt;
                    
                    // Update positions
                    x += vx * dt;
                    y += vy * dt;
                    
                    // Track maximum height
                    if (y > maxY) maxY = y;
                    
                    t += dt;
                    
                    // Stop if we've clearly hit the ground
                    if (y < 0) break;
                }
                
                flightTime = t;
                range = x;
                maxHeight = maxY;
            }

            // Display results
            const resultsDiv = document.getElementById('projectileResults');
            let dragInfo = beta === 0 ? "(No air resistance)" : `(With air resistance: Œ≤ = ${beta})`;
            
            resultsDiv.innerHTML = `
                <div class="output-item"><strong>$\\tau$ (Flight Time):</strong> ${flightTime.toFixed(3)} s ${dragInfo}</div>
                <div class="output-item"><strong>$R$ (Range):</strong> ${range.toFixed(3)} m</div>
                <div class="output-item"><strong>$H$ (Maximum Height):</strong> ${maxHeight.toFixed(3)} m</div>
                <div class="output-item"><strong>Initial Velocity Components:</strong><br>
                    $v_{0x} = ${v0x.toFixed(3)}$ m/s<br>
                    $v_{0y} = ${v0y.toFixed(3)}$ m/s
                </div>

            `;
            
            // Re-render MathJax
            MathJax.typesetPromise([resultsDiv]);
        }

        function animateProjectile() {
            stopAnimation();
            projectileIsPaused = false;
            document.getElementById('projectilePauseBtn').textContent = '‚è∏Ô∏è Pause';
            
            const canvas = document.getElementById('projectileCanvas');
            const ctx = canvas.getContext('2d');
            const graphCanvas = document.getElementById('projectileGraphs');
            const graphCtx = graphCanvas.getContext('2d');
            
            const v0 = parseFloat(document.getElementById('v0').value) * Math.pow(10, parseFloat(document.getElementById('v0_exp').value));
            const angleValue = parseFloat(document.getElementById('angle').value);
            const angle = angleValue * Math.PI / 180;
            const beta = parseFloat(document.getElementById('beta').value) * Math.pow(10, parseFloat(document.getElementById('beta_exp').value));
            const mass = parseFloat(document.getElementById('mass').value) * Math.pow(10, parseFloat(document.getElementById('mass_exp').value));
            const g = parseFloat(document.getElementById('g').value) * Math.pow(10, parseFloat(document.getElementById('g_exp').value));
            const timeSpeed = parseFloat(document.getElementById('timeSpeed').value);
            
            const v0x = v0 * Math.cos(angle);
            const v0y = v0 * Math.sin(angle);
            const scale = 8; // pixels per meter
            
            let t = 0;
            const dt = 0.02 * timeSpeed;
            let vx = v0x, vy = v0y;
            let x = 0, y = 0;
            
            const xData = [], yData = [], timeData = [];
            
            function animate() {
                if (projectileIsPaused) {
                    animationId = requestAnimationFrame(animate);
                    return;
                }
                
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                // Draw coordinate axes
                ctx.strokeStyle = '#34495e';
                ctx.lineWidth = 1;
                ctx.setLineDash([2, 2]);
                // X-axis
                ctx.beginPath();
                ctx.moveTo(20, canvas.height - 20);
                ctx.lineTo(canvas.width - 20, canvas.height - 20);
                ctx.stroke();
                // Y-axis
                ctx.beginPath();
                ctx.moveTo(20, 20);
                ctx.lineTo(20, canvas.height - 20);
                ctx.stroke();
                ctx.setLineDash([]);
                
                // Draw axis labels
                ctx.fillStyle = '#2c3e50';
                ctx.font = '12px Computer Modern';
                ctx.fillText('x (m)', canvas.width - 40, canvas.height - 5);
                ctx.fillText('y (m)', 5, 15);
                
                // Calculate dynamic scale based on current trajectory
                const maxXSeen = Math.max(...xData, x, 10);
                const maxYSeen = Math.max(...yData, y, 5);
                const dynamicScaleX = (canvas.width - 60) / maxXSeen;
                const dynamicScaleY = (canvas.height - 60) / maxYSeen;
                const currentScale = Math.min(dynamicScaleX, dynamicScaleY, scale);
                
                // Draw scale markers with dynamic scaling
                const xStep = Math.ceil(maxXSeen / 8);
                const yStep = Math.ceil(maxYSeen / 6);
                
                for (let i = 1; i <= Math.ceil(maxXSeen / xStep); i++) {
                    const xPos = 20 + i * xStep * currentScale;
                    if (xPos < canvas.width - 20) {
                        ctx.fillText((i * xStep).toFixed(0), xPos - 5, canvas.height - 5);
                        // Draw grid line
                        ctx.strokeStyle = '#ecf0f1';
                        ctx.setLineDash([1, 3]);
                        ctx.beginPath();
                        ctx.moveTo(xPos, 20);
                        ctx.lineTo(xPos, canvas.height - 20);
                        ctx.stroke();
                        ctx.setLineDash([]);
                    }
                }
                
                for (let i = 1; i <= Math.ceil(maxYSeen / yStep); i++) {
                    const yPos = canvas.height - 20 - i * yStep * currentScale;
                    if (yPos > 20) {
                        ctx.fillText((i * yStep).toFixed(0), 2, yPos + 3);
                        // Draw grid line
                        ctx.strokeStyle = '#ecf0f1';
                        ctx.setLineDash([1, 3]);
                        ctx.beginPath();
                        ctx.moveTo(20, yPos);
                        ctx.lineTo(canvas.width - 20, yPos);
                        ctx.stroke();
                        ctx.setLineDash([]);
                    }
                }
                
                // Draw trajectory path
                ctx.strokeStyle = '#3498db';
                ctx.lineWidth = 2;
                ctx.beginPath();
                let pathT = 0;
                let pathVx = v0x, pathVy = v0y;
                let pathX = 0, pathY = 0;
                ctx.moveTo(20, canvas.height - 20);
                
                while (pathY >= 0 && pathT < 20) {
                    if (beta > 0) {
                        const speed = Math.sqrt(pathVx * pathVx + pathVy * pathVy);
                        const dragX = -beta * pathVx / mass;
                        const dragY = -beta * pathVy / mass;
                        pathVx += dragX * dt;
                        pathVy += (dragY - g) * dt;
                    } else {
                        pathVy -= g * dt;
                    }
                    
                    pathX += pathVx * dt;
                    pathY += pathVy * dt;
                    
                    if (pathY >= 0) {
                        ctx.lineTo(20 + pathX * currentScale, canvas.height - 20 - pathY * currentScale);
                    }
                    pathT += dt;
                }
                ctx.stroke();
                
                // Update projectile position
                if (beta > 0) {
                    const speed = Math.sqrt(vx * vx + vy * vy);
                    const dragX = -beta * vx / mass;
                    const dragY = -beta * vy / mass;
                    vx += dragX * dt;
                    vy += (dragY - g) * dt;
                } else {
                    vy -= g * dt;
                }
                
                x += vx * dt;
                y += vy * dt;
                
                // Store data for graphs
                timeData.push(t);
                xData.push(x);
                yData.push(y);
                
                // Draw projectile
                if (y >= 0) {
                    ctx.fillStyle = '#e74c3c';
                    ctx.beginPath();
                    ctx.arc(20 + x * currentScale, canvas.height - 20 - y * currentScale, 6, 0, 2 * Math.PI);
                    ctx.fill();
                    
                    // Draw velocity vector with fixed size
                    const speed = Math.sqrt(vx * vx + vy * vy);
                    if (speed > 0.1) { // Only draw if there's meaningful velocity
                        ctx.strokeStyle = '#27ae60';
                        ctx.lineWidth = 4;
                        ctx.beginPath();
                        ctx.moveTo(20 + x * currentScale, canvas.height - 20 - y * currentScale);
                        
                        // Fixed vector length of 40 pixels, direction based on velocity
                        const fixedVecLength = 40;
                        const vecAngle = Math.atan2(-vy, vx);
                        const vecEndX = 20 + x * currentScale + fixedVecLength * Math.cos(vecAngle);
                        const vecEndY = canvas.height - 20 - y * currentScale + fixedVecLength * Math.sin(vecAngle);
                        ctx.lineTo(vecEndX, vecEndY);
                        ctx.stroke();
                        
                        // Draw velocity vector arrow
                        ctx.fillStyle = '#27ae60';
                        ctx.beginPath();
                        ctx.moveTo(vecEndX, vecEndY);
                        ctx.lineTo(vecEndX - 12 * Math.cos(vecAngle - 0.3), vecEndY - 12 * Math.sin(vecAngle - 0.3));
                        ctx.lineTo(vecEndX - 12 * Math.cos(vecAngle + 0.3), vecEndY - 12 * Math.sin(vecAngle + 0.3));
                        ctx.closePath();
                        ctx.fill();
                    }
                    
                    // Update time display
                    document.getElementById('projectileTime').textContent = t.toFixed(2);
                    
                    // Draw graphs
                    drawProjectileGraphs(graphCtx, timeData, xData, yData);
                    
                    t += dt;
                    animationId = requestAnimationFrame(animate);
                }
            }
            
            animate();
        }
        
        function drawProjectileGraphs(ctx, timeData, xData, yData) {
            ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
            
            if (timeData.length < 2) return;
            
            const margin = 60;
            const graphWidth = (ctx.canvas.width - 3 * margin) / 2;
            const graphHeight = ctx.canvas.height - 2 * margin;
            
            // Find max values for scaling
            const maxTime = Math.max(...timeData);
            const maxX = Math.max(...xData);
            const maxY = Math.max(...yData);
            
            ctx.font = '12px Computer Modern';
            ctx.fillStyle = '#2c3e50';
            
            // Draw x(t) graph
            ctx.strokeStyle = '#34495e';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.rect(margin, margin, graphWidth, graphHeight);
            ctx.stroke();
            
            // Draw x(t) grid and labels
            for (let i = 0; i <= 5; i++) {
                const timeVal = (maxTime * i) / 5;
                const xPos = margin + (i / 5) * graphWidth;
                ctx.strokeStyle = '#ecf0f1';
                ctx.beginPath();
                ctx.moveTo(xPos, margin);
                ctx.lineTo(xPos, margin + graphHeight);
                ctx.stroke();
                ctx.fillText(timeVal.toFixed(1), xPos - 10, margin + graphHeight + 15);
                
                const xVal = (maxX * i) / 5;
                const yPos = margin + graphHeight - (i / 5) * graphHeight;
                ctx.strokeStyle = '#ecf0f1';
                ctx.beginPath();
                ctx.moveTo(margin, yPos);
                ctx.lineTo(margin + graphWidth, yPos);
                ctx.stroke();
                ctx.fillText(xVal.toFixed(1), margin - 35, yPos + 4);
            }
            
            ctx.strokeStyle = '#e74c3c';
            ctx.lineWidth = 4;
            ctx.beginPath();
            for (let i = 0; i < timeData.length; i++) {
                const plotX = margin + (timeData[i] / maxTime) * graphWidth;
                const plotY = margin + graphHeight - (xData[i] / maxX) * graphHeight;
                if (i === 0) ctx.moveTo(plotX, plotY);
                else ctx.lineTo(plotX, plotY);
            }
            ctx.stroke();
            
            ctx.fillText('x(t) [m]', margin + graphWidth/2 - 15, margin - 20);
            ctx.fillText('t [s]', margin + graphWidth/2 - 10, margin + graphHeight + 35);
            
            // Draw y(t) graph
            const graph2X = margin * 2 + graphWidth;
            ctx.strokeStyle = '#34495e';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.rect(graph2X, margin, graphWidth, graphHeight);
            ctx.stroke();
            
            // Draw y(t) grid and labels
            for (let i = 0; i <= 5; i++) {
                const timeVal = (maxTime * i) / 5;
                const xPos = graph2X + (i / 5) * graphWidth;
                ctx.strokeStyle = '#ecf0f1';
                ctx.beginPath();
                ctx.moveTo(xPos, margin);
                ctx.lineTo(xPos, margin + graphHeight);
                ctx.stroke();
                ctx.fillText(timeVal.toFixed(1), xPos - 10, margin + graphHeight + 15);
                
                const yVal = (maxY * i) / 5;
                const yPos = margin + graphHeight - (i / 5) * graphHeight;
                ctx.strokeStyle = '#ecf0f1';
                ctx.beginPath();
                ctx.moveTo(graph2X, yPos);
                ctx.lineTo(graph2X + graphWidth, yPos);
                ctx.stroke();
                ctx.fillText(yVal.toFixed(1), graph2X - 35, yPos + 4);
            }
            
            ctx.strokeStyle = '#3498db';
            ctx.lineWidth = 4;
            ctx.beginPath();
            for (let i = 0; i < timeData.length; i++) {
                const plotX = graph2X + (timeData[i] / maxTime) * graphWidth;
                const plotY = margin + graphHeight - (yData[i] / maxY) * graphHeight;
                if (i === 0) ctx.moveTo(plotX, plotY);
                else ctx.lineTo(plotX, plotY);
            }
            ctx.stroke();
            
            ctx.fillText('y(t) [m]', graph2X + graphWidth/2 - 15, margin - 20);
            ctx.fillText('t [s]', graph2X + graphWidth/2 - 10, margin + graphHeight + 35);
        }

        function stopAnimation() {
            if (animationId) {
                cancelAnimationFrame(animationId);
                animationId = null;
            }
        }

        // Mass-Spring System Functions
        function calculateSpring() {
            const m = parseFloat(document.getElementById('springMass').value) * Math.pow(10, parseFloat(document.getElementById('springMass_exp').value));
            const k = parseFloat(document.getElementById('springK').value) * Math.pow(10, parseFloat(document.getElementById('springK_exp').value));
            const x0 = parseFloat(document.getElementById('springX0').value) * Math.pow(10, parseFloat(document.getElementById('springX0_exp').value));
            const v0 = parseFloat(document.getElementById('springV0').value) * Math.pow(10, parseFloat(document.getElementById('springV0_exp').value));
            
            const omega = Math.sqrt(k / m);
            const period = 2 * Math.PI / omega;
            const frequency = omega / (2 * Math.PI);
            
            let A, phi;
            
            A = Math.sqrt(x0 * x0 + (v0 / omega) * (v0 / omega));
                if (x0 !== 0) {
                    phi = Math.atan(-v0 / (omega * x0));
                } else if (v0 > 0) {
                    phi = -Math.PI / 2;
                } else if (v0 < 0) {
                    phi = Math.PI / 2;
                }
            
            // Display results
            const resultsDiv = document.getElementById('springResults');
            let resultsHTML = `
                <div class="output-item"><strong>$\\omega$ (Angular Frequency):</strong> ${omega.toFixed(3)} rad/s</div>
                <div class="output-item"><strong>$T$ (Period):</strong> ${period.toFixed(3)} s</div>
                <div class="output-item"><strong>$\\nu$ (Frequency):</strong> ${frequency.toFixed(3)} Hz</div>
                <div class="output-item"><strong>$A$ (Amplitude):</strong> ${A.toFixed(3)} m</div>
                <div class="output-item"><strong>$\\phi$ (Phase Angle):</strong> ${phi.toFixed(3)} rad</div>
                `;
            
            resultsDiv.innerHTML = resultsHTML;
            
            MathJax.typesetPromise([resultsDiv]);
        }

        function animateSpring() {
            stopSpringAnimation();
            springIsPaused = false;
            document.getElementById('springPauseBtn').textContent = '‚è∏Ô∏è Pause';
            
            const canvas = document.getElementById('springCanvas');
            const ctx = canvas.getContext('2d');
            const graphCanvas = document.getElementById('springGraphs');
            const graphCtx = graphCanvas.getContext('2d');
            
            const mass = parseFloat(document.getElementById('springMass').value) * Math.pow(10, parseFloat(document.getElementById('springMass_exp').value));
            const k = parseFloat(document.getElementById('springK').value) * Math.pow(10, parseFloat(document.getElementById('springK_exp').value));
            const x0 = parseFloat(document.getElementById('springX0').value) * Math.pow(10, parseFloat(document.getElementById('springX0_exp').value));
            const v0 = parseFloat(document.getElementById('springV0').value) * Math.pow(10, parseFloat(document.getElementById('springV0_exp').value));
            const timeSpeed = parseFloat(document.getElementById('springTimeSpeed').value);
            
            const omega = Math.sqrt(k / mass);
            const A = Math.sqrt(x0 * x0 + (v0 / omega) * (v0 / omega));
            let phi = 0;
            if (x0 !== 0) {
                phi = Math.atan(-v0 / (omega * x0));
            } else if (v0 > 0) {
                phi = -Math.PI / 2;
            } else if (v0 < 0) {
                phi = Math.PI / 2;
            }
            
            const scale = 800; // pixels per meter
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            
            let t = 0;
            const dt = 0.02 * timeSpeed;
            const xData = [], timeData = [];
            
            function animate() {
                if (springIsPaused) {
                    springAnimationId = requestAnimationFrame(animate);
                    return;
                }
                
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                // Calculate position and velocity
                let x, v;
                x = A * Math.cos(omega * t + phi);
                v = -A * omega * Math.sin(omega * t + phi);
                
                // Store data for graph
                timeData.push(t);
                xData.push(x);
                
                // Draw wall - made taller and positioned further left
                ctx.fillStyle = '#7f8c8d';
                ctx.fillRect(30, centerY - 80, 25, 160);
                
                // Draw x-axis - extended to cover more range
                ctx.strokeStyle = '#34495e';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(55, centerY);
                ctx.lineTo(canvas.width - 30, centerY);
                ctx.stroke();
                
                // Calculate dynamic scale for spring system with more generous boundaries
                const maxXSpring = Math.max(...xData.map(Math.abs), Math.abs(x), 0.1);
                const availableWidth = canvas.width - 160; // More space for oscillation
                const dynamicSpringScale = Math.min(scale, availableWidth / (3 * maxXSpring)); // 3x amplitude for comfortable viewing
                
                // Draw x-axis scale markers with more spacing and fewer divisions
                ctx.fillStyle = '#2c3e50';
                ctx.font = '12px Computer Modern';
                
                const equilibriumX = 200; // Equilibrium position
                const numDivisions = 3; // Reduced from 5 to 3 for more spacing
                
                for (let i = -numDivisions; i <= numDivisions; i++) {
                    if (i !== 0) {
                        const xValue = (i / numDivisions) * maxXSpring;
                        const xPos = equilibriumX + xValue * dynamicSpringScale;
                        if (xPos > 80 && xPos < canvas.width - 50) {
                            ctx.strokeStyle = '#34495e';
                            ctx.lineWidth = 2;
                            ctx.beginPath();
                            ctx.moveTo(xPos, centerY - 5);
                            ctx.lineTo(xPos, centerY + 5);
                            ctx.stroke();
                            
                            ctx.fillText(xValue.toFixed(3), xPos - 15, centerY + 20);
                            
                            // Draw grid line with more spacing
                            ctx.strokeStyle = '#ecf0f1';
                            ctx.lineWidth = 1;
                            ctx.setLineDash([1, 3]);
                            ctx.beginPath();
                            ctx.moveTo(xPos, centerY - 50);
                            ctx.lineTo(xPos, centerY + 50);
                            ctx.stroke();
                            ctx.setLineDash([]);
                        }
                    }
                }
                ctx.fillText('x (m)', canvas.width - 35, centerY + 20);
                ctx.fillText('0', equilibriumX - 8, centerY + 20);
                
                // Draw spring
                ctx.strokeStyle = '#34495e';
                ctx.lineWidth = 3;
                ctx.beginPath();
                
                const naturalLength = 145; // Natural spring length from wall to equilibrium
                const springLength = naturalLength + x * dynamicSpringScale;
                const coils = 10; // More coils for better visual
                const coilWidth = 18;
                
                ctx.moveTo(55, centerY);
                for (let i = 0; i < coils; i++) {
                    const segmentLength = springLength / coils;
                    const startX = 55 + i * segmentLength;
                    const endX = startX + segmentLength;
                    const midX = (startX + endX) / 2;
                    
                    if (i % 2 === 0) {
                        ctx.lineTo(midX, centerY - coilWidth);
                        ctx.lineTo(endX, centerY);
                    } else {
                        ctx.lineTo(midX, centerY + coilWidth);
                        ctx.lineTo(endX, centerY);
                    }
                }
                ctx.stroke();
                
                // Draw mass
                const massX = 55 + springLength;
                ctx.fillStyle = '#e74c3c';
                ctx.fillRect(massX - 15, centerY - 15, 30, 30);
                
                // Draw velocity vector with fixed size
                if (Math.abs(v) > 0.01) {
                    ctx.strokeStyle = '#27ae60';
                    ctx.lineWidth = 5;
                    ctx.beginPath();
                    ctx.moveTo(massX, centerY);
                    
                    // Fixed vector length of 50 pixels, direction based on velocity
                    const fixedVecLength = 50;
                    const vecEndX = massX + (v > 0 ? fixedVecLength : -fixedVecLength);
                    ctx.lineTo(vecEndX, centerY);
                    ctx.stroke();
                    
                    // Draw arrow
                    ctx.fillStyle = '#27ae60';
                    ctx.beginPath();
                    ctx.moveTo(vecEndX, centerY);
                    if (v > 0) {
                        ctx.lineTo(vecEndX - 15, centerY - 8);
                        ctx.lineTo(vecEndX - 15, centerY + 8);
                    } else {
                        ctx.lineTo(vecEndX + 15, centerY - 8);
                        ctx.lineTo(vecEndX + 15, centerY + 8);
                    }
                    ctx.closePath();
                    ctx.fill();
                }
                
                // Draw equilibrium position marker
                ctx.strokeStyle = '#95a5a6';
                ctx.lineWidth = 2;
                ctx.setLineDash([5, 5]);
                ctx.beginPath();
                ctx.moveTo(equilibriumX, centerY - 50);
                ctx.lineTo(equilibriumX, centerY + 50);
                ctx.stroke();
                ctx.setLineDash([]);
                
                // Mark equilibrium position
                ctx.fillStyle = '#95a5a6';
                ctx.font = '12px Computer Modern';
                ctx.fillText('Equilibrium', equilibriumX + 5, centerY - 55);
                
                // Draw position and time indicators
                ctx.fillStyle = '#2c3e50';
                ctx.font = '14px Computer Modern';
                ctx.fillText(`x = ${x.toFixed(4)} m`, 10, 30);
                ctx.fillText(`v = ${v.toFixed(4)} m/s`, 10, 50);
                
                // Update time display
                document.getElementById('springTime').textContent = t.toFixed(2);
                
                // Draw graph
                drawSpringGraph(graphCtx, timeData, xData);
                
                t += dt;
                springAnimationId = requestAnimationFrame(animate);
            }
            
            animate();
        }
        
        function drawSpringGraph(ctx, timeData, xData) {
            ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
            
            if (timeData.length < 2) return;
            
            const margin = 60;
            const graphWidth = ctx.canvas.width - 2 * margin;
            const graphHeight = ctx.canvas.height - 2 * margin;
            
            // Find max values for scaling
            const maxTime = Math.max(...timeData);
            const maxX = Math.max(...xData.map(Math.abs));
            
            ctx.font = '12px Computer Modern';
            ctx.fillStyle = '#2c3e50';
            
            // Draw main axes
            ctx.strokeStyle = '#34495e';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.rect(margin, margin, graphWidth, graphHeight);
            ctx.moveTo(margin, margin + graphHeight/2);
            ctx.lineTo(margin + graphWidth, margin + graphHeight/2);
            ctx.stroke();
            
            // Draw grid and labels for time axis
            for (let i = 0; i <= 5; i++) {
                const timeVal = (maxTime * i) / 5;
                const xPos = margin + (i / 5) * graphWidth;
                ctx.strokeStyle = '#ecf0f1';
                ctx.beginPath();
                ctx.moveTo(xPos, margin);
                ctx.lineTo(xPos, margin + graphHeight);
                ctx.stroke();
                ctx.fillText(timeVal.toFixed(1), xPos - 10, margin + graphHeight + 15);
            }
            
            // Draw grid and labels for position axis
            for (let i = 0; i <= 4; i++) {
                const xVal = (maxX * (i - 2)) / 2;
                const yPos = margin + (i / 4) * graphHeight;
                ctx.strokeStyle = '#ecf0f1';
                ctx.beginPath();
                ctx.moveTo(margin, yPos);
                ctx.lineTo(margin + graphWidth, yPos);
                ctx.stroke();
                if (i !== 2) {
                    ctx.fillText(xVal.toFixed(3), margin - 45, yPos + 4);
                }
            }
            ctx.fillText('0', margin - 15, margin + graphHeight/2 + 4);
            
            // Draw x(t) graph
            ctx.strokeStyle = '#e74c3c';
            ctx.lineWidth = 4;
            ctx.beginPath();
            for (let i = 0; i < timeData.length; i++) {
                const plotX = margin + (timeData[i] / maxTime) * graphWidth;
                const plotY = margin + graphHeight/2 - (xData[i] / maxX) * (graphHeight/2 - 10);
                if (i === 0) ctx.moveTo(plotX, plotY);
                else ctx.lineTo(plotX, plotY);
            }
            ctx.stroke();
            
            // Labels
            ctx.fillText('x(t) [m]', margin + graphWidth/2 - 15, margin - 20);
            ctx.fillText('t [s]', margin + graphWidth/2 - 10, margin + graphHeight + 35);
        }

        function stopSpringAnimation() {
            if (springAnimationId) {
                cancelAnimationFrame(springAnimationId);
                springAnimationId = null;
            }
        }

        // Lens Functions
        function calculateLens() {
            const s = parseFloat(document.getElementById('lenss').value) * Math.pow(10, parseFloat(document.getElementById('lenss_exp').value));
            const h = parseFloat(document.getElementById('lensh').value) * Math.pow(10, parseFloat(document.getElementById('lensh_exp').value));
            const f = parseFloat(document.getElementById('lensf').value) * Math.pow(10, parseFloat(document.getElementById('lensf_exp').value));
            
            let s_image, mag, h_image;
            
            s_image = (f*s)/(s-f);
            mag = (-f)/(s-f);
            h_image = (h*f)/(f-s);
            
            
            // Display results
            const resultsDiv = document.getElementById('lensResults');
            let resultsHTML = `
                <div class="output-item"><strong>$s'$ (Image Distance):</strong> ${s_image.toFixed(3)} m</div>
                <div class="output-item"><strong>$\\mathcal{M}$ (Magnification):</strong> ${mag.toFixed(3)} </div>
                <div class="output-item"><strong>$h'$ (Image Height):</strong> ${h_image.toFixed(3)} m</div>
                `;
            
            resultsDiv.innerHTML = resultsHTML;
            
            MathJax.typesetPromise([resultsDiv]);
        }

        function animateLens() {
            const canvas = document.getElementById("lensCanvas");
            const ctx = canvas.getContext("2d");
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const s = parseFloat(document.getElementById("lenss").value) * Math.pow(10, parseFloat(document.getElementById("lenss_exp").value));
            const h = parseFloat(document.getElementById("lensh").value) * Math.pow(10, parseFloat(document.getElementById("lensh_exp").value));
            const f = parseFloat(document.getElementById("lensf").value) * Math.pow(10, parseFloat(document.getElementById("lensf_exp").value));

            const s_prime = (f * s) / (s - f);
            const m = -s_prime / s;
            const h_prime = h * m;

            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const maxX = Math.max(Math.abs(s), Math.abs(s_prime), Math.abs(f)) * 1.2;
            const maxY = Math.max(Math.abs(h), Math.abs(h_prime)) * 2;
            const scaleX = (canvas.width / 2 - 40) / maxX;
            const scaleY = (canvas.height / 2 - 30) / maxY;
            const scale = Math.max(10, Math.min(scaleX, scaleY));
            const X = x => centerX + x * scale;
            const Y = y => centerY - y * scale;

            // Draw legend
            ctx.fillStyle = "#333";
            ctx.font = "14px sans-serif";
            ctx.fillText("üî¥ Object", 10, 20);
            ctx.fillText("üü¢ Image", 10, 40);
            ctx.fillText("üîµ Lens Axis", 10, 60);
            ctx.fillText("üü° Ray", 10, 80);

            // Principal axis
            ctx.strokeStyle = "#333";
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(0, centerY);
            ctx.lineTo(canvas.width, centerY);
            ctx.stroke();

            // Lens as blue line
            ctx.strokeStyle = "#0080ff";
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(centerX, 0);
            ctx.lineTo(centerX, canvas.height);
            ctx.stroke();

            // Focal points
            ctx.fillStyle = "black";
            ctx.beginPath();
            ctx.arc(X(f), centerY, 3, 0, 2 * Math.PI);
            ctx.arc(X(-f), centerY, 3, 0, 2 * Math.PI);
            ctx.fill();
            ctx.fillText("F", X(f) + 4, centerY - 6);
            ctx.fillText("F", X(-f) - 14, centerY - 6);

            // Object
            ctx.strokeStyle = "#e74c3c";
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(X(-s), centerY);
            ctx.lineTo(X(-s), Y(h));
            ctx.stroke();
            ctx.beginPath();
            ctx.arc(X(-s), Y(h), 4, 0, 2 * Math.PI);
            ctx.fillStyle = "#e74c3c";
            ctx.fill();

            // Image
            ctx.strokeStyle = "#27ae60";
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(X(s_prime), centerY);
            ctx.lineTo(X(s_prime), Y(h_prime));
            ctx.stroke();
            ctx.beginPath();
            ctx.arc(X(s_prime), Y(h_prime), 4, 0, 2 * Math.PI);
            ctx.fillStyle = "#27ae60";
            ctx.fill();

            // === Ray 1: Parallel Ray ===
            ctx.strokeStyle = "#ff9900";
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(X(-s), Y(h));
            ctx.lineTo(X(0), Y(h));
            ctx.stroke();
            
            if (f>0) {
                if (s > f) {
                    // Convex: refracted through F
                    ctx.strokeStyle = "#ff9900"
                    ctx.beginPath();
                    ctx.moveTo(X(0), Y(h));
                    ctx.lineTo(X(s_prime), Y(h_prime));
                    ctx.stroke();

                    // === Ray 2: Through center ===
                    ctx.strokeStyle = "#ff9900";
                    ctx.beginPath();
                    ctx.moveTo(X(-s), Y(h));
                    ctx.lineTo(X(s_prime), Y(h_prime));
                    ctx.stroke();
                } else if (s < f) {
                    // Concave: diverge, but extend backward to F'
                    const backLength = 1.5;
                    const angle = Math.atan2(centerY - Y(h), X(0) - X(-f));
                    const angle2 = Math.atan2(centerY - Y(h), X(0) - X(-s));
                    const endX = X(0) + backLength * scale * Math.cos(angle);
                    const endY = Y(h) + backLength * scale * Math.sin(angle);
                    const endX2 = X(-s) + backLength * scale * Math.cos(angle2);
                    const endY2 = Y(h) + backLength * scale * Math.sin(angle2);

                    // Refracted ray (forward)
                    ctx.strokeStyle = "#ff9900"
                    ctx.beginPath();
                    ctx.moveTo(X(0), Y(h));
                    ctx.lineTo(endX, endY);
                    ctx.stroke();

                    // Dashed extension backward to F'
                    ctx.strokeStyle = "#ff9900"
                    ctx.setLineDash([4, 3]);
                    ctx.beginPath();
                    ctx.moveTo(X(0), Y(h));
                    ctx.lineTo(X(s_prime), Y(h_prime));
                    ctx.stroke();
                    ctx.setLineDash([]);

                    // === Ray 2: Through center ===
                    ctx.strokeStyle = "#ff9900";
                    ctx.setLineDash([4, 3]);
                    ctx.beginPath();
                    ctx.moveTo(X(-s), Y(h));
                    ctx.lineTo(X(s_prime), Y(h_prime));
                    ctx.stroke();
                    ctx.setLineDash([]);

                    // Refracted ray (forward)
                    ctx.strokeStyle = "#ff9900"
                    ctx.beginPath();
                    ctx.moveTo(X(-s), Y(h));
                    ctx.lineTo(endX2, endY2);
                    ctx.stroke();
                }
            } else if (f<0) {
                    const backLength = 1.5;
                    const angle3 = Math.atan2(centerY - Y(-h), X(0) - X(f));
                    const angle4 = Math.atan2(centerY - Y(h), X(0) - X(-s));
                    const endX3 = X(0) + backLength * scale * Math.cos(angle3);
                    const endY3 = Y(h) + backLength * scale * Math.sin(angle3);
                    const endX4 = X(-s_prime) + backLength * scale * Math.cos(angle4);
                    const endY4 = Y(h_prime) + backLength * scale * Math.sin(angle4);
                    // Convex: refracted through F
                    ctx.strokeStyle = "#ff9900"
                    ctx.setLineDash([4, 3]);
                    ctx.beginPath();
                    ctx.moveTo(X(0), Y(h));
                    ctx.lineTo(X(s_prime), Y(h_prime));
                    ctx.stroke();
                    ctx.setLineDash([]);

                    ctx.strokeStyle = "#ff9900"
                    ctx.beginPath();
                    ctx.moveTo(X(0), Y(h));
                    ctx.lineTo(endX3, endY3);
                    ctx.stroke();

                    // === Ray 2: Through center ===
                    ctx.strokeStyle = "#ff9900";
                    ctx.beginPath();
                    ctx.moveTo(X(-s), Y(h));
                    ctx.lineTo(X(s_prime), Y(h_prime));
                    ctx.stroke();

                    ctx.strokeStyle = "#ff9900"
                    ctx.setLineDash([4, 3]);
                    ctx.beginPath();
                    ctx.moveTo(X(s_prime), Y(h_prime));
                    ctx.lineTo(endX4, endY4);
                    ctx.stroke();
                    ctx.setLineDash([]);
            }
        }

        // Initialize MathJax rendering
        window.addEventListener('load', function() {
            MathJax.typesetPromise();
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'969dc933e67826cd',t:'MTc1NDMwNzY5MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
